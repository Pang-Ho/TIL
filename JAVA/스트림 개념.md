# 스트림

다양한 데이터 소스(컬렉션, 배열)를 표준화된 방법으로 다루기 위한 것

Collection Framework - List, Set, Map을 표준화된 방식으로 사용하기 위해 만든 프레임워크
그러나, List, Set, Map은 서로 사용하는 방법이 달랐다

JDK 1.8이 나오면서 이러한 데이터 소스를 사용하는 표준화된 방법(스트림)이 나왔다.

컬렉션, 배열 -> Stream -> 중간 연산 -> 최종 연산



## 스트림?

데이터소스 Stream을 통해서 연속적으로 하나씩 전달되어 중간과정으로...
Stream - 데이터의 연속적인 흐름
중간연산 - 연산결과가 스트림인 연산
최종연산 - 연산결과가 스트림이 아닌 연산



## 데이터 소스를 Stream으로 바꾸는 방법

Stream\<T> Collection stream()

~~~java
List<Integer> list = Arrays.asList(1,2,3,4,5);

Stream<Integer> intStream = list.stream();
Stream<String> strStream = Stream.of(new String[]{"a", "b", "c"}); //배열
Stream<Integer> evenStream = Stream.inerate(0, n->n+2); // 0,2,4,6...
Stream<Double> randomStream = Stream.generate(Math::random); //람다식
IntStream intStream = new Random().ints(5); //난수 스트림(크기가 5)
~~~



## 스트림이 제공하는 기능 - 중간 연산과 최종 연산

중간연산(0 ~ n번) - 연산결과가 스트림인 연산. 반복적으로 적용가능
최종연산(0 ~ 1번) - 연산결과가 스트림이 아닌 연산. 단 한번만 적용 가능(스트림의 요소를 소모)

~~~java
stream.distinct().limit(5).sorted().forEach(System.out::println);
//      중간연산     중간연산   중간연산    최종연산
//      중복제거     5개자르기   정렬       출력
~~~



~~~java
String[] strArr = { "dd", "aaa", "CC", "b"};
Stream<String> stream = Stream.of(strArr); //문자열 배열이 소스인 스트림
Stream<String> filteredStream = stream.filter(); // 걸러내기(중간연산)
Stream<String> distinctedStream = stream.distinct(); // 중복제거(중간연산)
Stream<String> sortedStream = stream.sort(); // 정렬(중간연산)
Stream<STring> limitedStream = stream.limit(5); // 스트림 자르기(중간연산)
int total = stream.count(); // 요소 개수 세기(최종연산)
~~~



## 스트림 특징

1. 스트림은 데이터 소스로부터 데이터를 읽기만할 뿐 변경하지 않는다.

   ~~~java
   List<Integer> list = Arrays.asList(3,1,5,4,2);
   List<Integer> sortedList = list.stream().sorted().collect(Collectors.toList());
   ~~~

   

2. 스트림은 Iterator 처럼 일회용이다.(필요하면 다시 스트림을 생성해야 함)

   ~~~java
   strStream.forEach(System.out::println); 
   int num = strStream.count(); // error 스트림이 닫혀있습니다.
   // forEach처럼 최종연산을 하는 메서드는 스트림에 있는 내용을 다 빼서 사용함. 즉, 스트림을 다시 부르면 에러가 남
   
   ~~~

   

3. 최종 연산 전까지 중간연산이 수행되지 않는다. - 지연된 연산

   ~~~java
   InteStream intStream = new Random().ints(1,46); // 1~45
   intStream.distinct().limit(6).sorted()					// 중간 연산
     				.forEach(i->System.out.print(i+",")); // 최종 연산
   ~~~

   

4. 스트림은 작업을 내부 반복으로 처리한다. (forEach 메서드에는 내부 반복문이 있다.) 그 결과 코드가 간결해진다.

   ~~~java
   for(String str : strList) System.out.println(str);
   
   Stream.forEach(System.out::println);
   ~~~

   

5. 스트림의 작업을 병렬로 처리 - 병렬 스트림

   ~~~java
   int sum = strStream.parallel() //병렬 스트림으로 전환(속성만 변경)
     					.mapToInt(s -> s.length()).sum(); // 모든 문자열의 길이의 합
   ~~~

   

6. 기본형 스트림 - IntStream, LongStream, DoubleStream
   int[] 배열이 Stream\<Integer>이 될 때 기본형 int가 Integer 참조형으로 변환됨.(오토박싱)
   이 불필요한 변환을 없애기 위해 기본형 스트림을 제공해줌.

   오토박싱&언박싱의 비효율이 제거됨(Stream\<Integer> 대신 IntStream 사용)

   숫자와 관련된 유용한 메서드를 Stream\<T>보다 더 많이 제공해준다.

